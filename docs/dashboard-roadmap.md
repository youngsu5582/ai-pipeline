# AI Pipeline Dashboard 로드맵

## 현재 완료된 기능
- [x] 작업 CRUD (카드 뷰)
- [x] 그래프 뷰 (vis-network)
- [x] 수동/스케줄 실행
- [x] 실행 옵션 (플래그, 선택 등)
- [x] 실행 이력 (기본)
- [x] Slack 알림
- [x] 카테고리 필터
- [x] 실시간 로그 보기

## 작성된 명세 (구현 대기)
- [ ] 파이프라인 체이닝 (`pipeline-chaining-spec.md`)
- [ ] 실행 이력 개선 (`history-enhancement-spec.md`)

---

## TODO LIST

### 🔴 P0: 핵심 기능 (Must Have)

| # | 기능 | 설명 | 난이도 | 예상 작업 |
|---|------|------|--------|----------|
| 1 | **파이프라인 체이닝** | A→B 자동 실행 | 중 | 명세 완료, 구현만 |
| 2 | **실행 이력 개선** | 페이지네이션, 검색, 날짜 필터 | 중 | 명세 완료, 구현만 |
| 3 | **설정 페이지** | Slack webhook, 대시보드 URL 등 UI에서 설정 | 하 | 새 탭 + API |
| 4 | **작업 복제** | 기존 작업 복사해서 새로 만들기 | 하 | 버튼 + API |
| 5 | **실패 재시도** | 실패 시 N회 자동 재시도 | 중 | job 옵션 + 로직 |

### 🟠 P1: 편의 기능 (Should Have)

| # | 기능 | 설명 | 난이도 | 예상 작업 |
|---|------|------|--------|----------|
| 6 | **작업 import/export** | JSON으로 백업/복원 | 하 | API + 다운로드 |
| 7 | **일회성 예약 실행** | 특정 시간에 1회 실행 | 중 | 스케줄러 확장 |
| 8 | **작업 timeout** | N분 후 강제 종료 | 중 | spawn 옵션 |
| 9 | **브라우저 알림** | 실행 완료/실패 시 푸시 알림 | 하 | Notification API |
| 10 | **토스트 알림** | 액션 성공/실패 피드백 | 하 | UI 컴포넌트 |
| 11 | **키보드 단축키** | R=실행, E=편집, N=새작업 등 | 하 | 이벤트 리스너 |
| 12 | **작업 메모** | 비활성화 사유, 주의사항 등 | 하 | 필드 추가 |

### 🟡 P2: 분석/모니터링 (Nice to Have)

| # | 기능 | 설명 | 난이도 | 예상 작업 |
|---|------|------|--------|----------|
| 13 | **통계 대시보드** | 성공률, 평균 시간, 일별 실행 수 | 중 | 새 탭 + 차트 |
| 14 | **실행 시간 차트** | 작업별 실행 시간 추이 | 중 | Chart.js |
| 15 | **작업 의존성 시각화** | 파이프라인 전체 플로우 | 중 | 그래프 뷰 확장 |
| 16 | **로그 검색** | stdout/stderr 내용 검색 | 중 | 인덱싱 필요 |
| 17 | **알림 채널 확장** | Discord, Email, Telegram | 중 | 모듈화 |

### 🟢 P3: 고급 기능 (Future)

| # | 기능 | 설명 | 난이도 | 예상 작업 |
|---|------|------|--------|----------|
| 18 | **조건부 실행** | 이전 출력 기반 분기 | 상 | 표현식 파서 |
| 19 | **병렬 파이프라인** | A→[B,C]→D 형태 | 상 | 복잡한 그래프 |
| 20 | **파이프라인 템플릿** | 자주 쓰는 워크플로우 저장 | 중 | 별도 스키마 |
| 21 | **API 토큰** | 외부에서 작업 트리거 | 중 | 인증 미들웨어 |
| 22 | **멀티 사용자** | 로그인, 권한 관리 | 상 | 전체 구조 변경 |
| 23 | **Docker 배포** | Dockerfile, docker-compose | 중 | 환경 설정 |
| 24 | **원격 실행** | SSH로 다른 서버에서 실행 | 상 | SSH 연동 |

---

## 상세 명세

### #3 설정 페이지

```
새 탭: ⚙️ 설정

섹션:
1. 알림 설정
   - Slack Webhook URL (마스킹 표시)
   - 기본 알림 활성화 여부

2. 대시보드 설정
   - 대시보드 URL (Slack 링크용)
   - 자동 새로고침 간격 (기본 5초)
   - 테마 (다크/라이트) - 미래

3. 실행 설정
   - 기본 timeout (분)
   - 기본 재시도 횟수

저장 위치: jobs.json의 settings 객체
```

### #4 작업 복제

```
위치: 작업 카드 메뉴, 그래프 컨텍스트 메뉴

동작:
1. "복제" 클릭
2. 기존 작업 데이터 복사
3. 이름에 " (복사본)" 추가
4. ID 새로 생성
5. enabled = false로 설정
6. 편집 모달 열기
```

### #5 실패 재시도

```
작업 옵션 추가:
{
  "retry": {
    "maxAttempts": 3,
    "delayMs": 5000,
    "backoff": "exponential"  // linear, exponential, fixed
  }
}

로직:
- 실패 시 retry.maxAttempts까지 재시도
- 각 시도 사이 delayMs 대기
- 이력에 attempt 번호 표시
```

### #6 작업 import/export

```
Export:
- GET /api/export → jobs.json 전체 다운로드
- UI: 설정 탭에 "내보내기" 버튼

Import:
- POST /api/import (multipart/form-data)
- 기존 데이터와 병합 또는 덮어쓰기 선택
- UI: 설정 탭에 "가져오기" 버튼 + 파일 선택
```

### #9 브라우저 알림

```javascript
// 권한 요청
if (Notification.permission === 'default') {
  Notification.requestPermission();
}

// 작업 완료 시
function notifyBrowser(job, status) {
  if (Notification.permission !== 'granted') return;

  new Notification(`${job.name} ${status === 'success' ? '완료' : '실패'}`, {
    body: status === 'success' ? '작업이 성공적으로 완료되었습니다.' : '작업 실행 중 오류가 발생했습니다.',
    icon: status === 'success' ? '/icons/success.png' : '/icons/error.png'
  });
}
```

### #11 키보드 단축키

```
전역:
- N: 새 작업 추가 모달
- /: 검색 포커스
- 1: 작업 목록 탭
- 2: 실행 이력 탭
- 3: 설정 탭 (추가 시)
- G: 그래프 뷰 토글
- Esc: 모달 닫기

작업 선택 시:
- R: 실행
- E: 편집
- D: 삭제 (확인 필요)
- T: 활성화/비활성화 토글
```

### #13 통계 대시보드

```
새 탭: 📊 통계

카드:
- 오늘 실행 수 (성공/실패)
- 이번 주 성공률
- 평균 실행 시간
- 가장 많이 실패한 작업

차트:
- 일별 실행 수 (7일)
- 작업별 성공률 (바 차트)
- 실행 시간 추이 (라인 차트)

라이브러리: Chart.js (CDN)
```

---

## 구현 순서 제안

### Phase 1: 핵심 완성 (1-2주)
```
1. 파이프라인 체이닝 구현 (명세 있음)
2. 실행 이력 개선 구현 (명세 있음)
3. 설정 페이지
4. 작업 복제
```

### Phase 2: 안정화 (1주)
```
5. 실패 재시도
6. 작업 timeout
7. 토스트 알림
8. 브라우저 알림
```

### Phase 3: 편의성 (1주)
```
9. 작업 import/export
10. 키보드 단축키
11. 작업 메모
```

### Phase 4: 분석 (1-2주)
```
12. 통계 대시보드
13. 실행 시간 차트
```

### Phase 5: 고급 (미정)
```
14+ 조건부 실행, 병렬 파이프라인 등
```

---

## 기술 부채

| 항목 | 현재 | 개선 방향 |
|------|------|----------|
| 코드 구조 | 단일 HTML 파일 | 모듈 분리 (ES modules) |
| 상태 관리 | 전역 변수 | 상태 객체로 통합 |
| API 에러 처리 | 콘솔 로그 | 토스트 알림으로 표시 |
| 이력 저장 | JSON 파일 | SQLite 고려 (대용량 시) |
| 테스트 | 없음 | API 테스트 추가 |

---

## 참고

### 우선순위 기준
- 🔴 P0: 현재 워크플로우에 필수
- 🟠 P1: 일상 사용 편의성
- 🟡 P2: 장기 운영 시 필요
- 🟢 P3: 확장성, 팀 사용 시

### 난이도 기준
- 하: 1-2시간
- 중: 반나절~하루
- 상: 2일 이상
